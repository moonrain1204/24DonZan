<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½›ä¹˜å‹•ç¦ª 24 å¼ (V1.2 æ™ºæ…§å„²å­˜ç‰ˆ)</title>
    <style>
        :root {
            --primary-color: #8e44ad;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
            --accent-color: #f1c40f;
            --play-color: #27ae60;
            --stop-color: #e74c3c;
            --note-bg: #eef7ff;
            --save-btn: #2ecc71;
        }

        body {
            font-family: "Microsoft JhengHei", sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
        }

        .container { max-width: 800px; margin: 0 auto; }
        
        .version-tag { text-align: right; font-size: 0.8rem; color: #888; margin-bottom: -10px; }

        header { text-align: center; padding: 20px 0; border-bottom: 2px solid var(--primary-color); margin-bottom: 30px; }

        .zen-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(140px, 1fr)); gap: 12px; }

        .zen-item {
            background: var(--card-bg);
            padding: 15px;
            text-align: center;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            font-weight: bold;
            border: 1px solid #ddd;
        }

        .zen-item:hover { background: #f0e6ff; border-color: var(--primary-color); }

        #detail-view { display: none; background: var(--card-bg); padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }

        .back-btn { background: #95a5a6; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-bottom: 20px; }
        
        .save-btn { 
            background: var(--save-btn); color: white; border: none; padding: 15px 25px; 
            border-radius: 5px; cursor: pointer; font-size: 1.1rem; width: 100%; 
            margin-top: 30px; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        }

        .section-title { color: var(--primary-color); border-left: 5px solid var(--primary-color); padding-left: 10px; margin: 25px 0 10px; }

        /* è‡ªå‹•ä¼¸ç¸®é«˜åº¦çš„ textarea */
        textarea {
            width: 100%;
            min-height: 80px;
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 8px;
            font-family: inherit;
            font-size: 1.05rem;
            line-height: 1.6;
            background-color: #fff;
            box-sizing: border-box;
            resize: none; /* ç¦æ­¢æ‰‹å‹•èª¿æ•´ï¼Œæ”¹ç”±å…§å®¹è‡ªå‹•æ’é–‹ */
            overflow: hidden; /* éš±è—æ»¾å‹•æ¢ */
        }

        .note-area { background-color: var(--note-bg); border-color: #3498db; }
        .qi-area { background-color: #fcfcfc; border-left: 4px solid #27ae60; }
        .no-qi-area { background-color: #fffaf0; border-left: 4px solid #f39c12; }

        .audio-controls { margin-bottom: 20px; }
        .audio-row { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; background: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px solid #eee; }
        .audio-label { font-weight: bold; min-width: 80px; }
        .icon-btn { border: none; width: 40px; height: 40px; border-radius: 5px; cursor: pointer; color: white; font-size: 1.2rem; }
    </style>
</head>
<body>

<div class="container">
    <div class="version-tag">Version 1.2</div>
    <header>
        <h1>ä½›ä¹˜å‹•ç¦ª 24 å¼</h1>
        <p>å¿ƒç†åŠŸèª²åŠç”Ÿç†åŠŸèª² (è‡ªå‹•ä¼¸ç¸®æ¬„ä½ç‰ˆ)</p>
    </header>

    <div id="main-list" class="zen-list"></div>

    <div id="detail-view">
        <button class="back-btn" onclick="showList()">â† è¿”å›åˆ—è¡¨</button>
        <h2 id="detail-title"></h2>

        <div class="audio-controls">
            <div class="audio-row" id="audio-row-1">
                <span class="audio-label" id="label-qi">å£è¨£ï¼š</span>
                <button class="icon-btn" style="background:var(--play-color)" onclick="playAudio(1)">â–¶</button>
                <button class="icon-btn" style="background:var(--stop-color)" onclick="stopAudio()">â– </button>
            </div>
            <div class="audio-row" id="audio-row-2" style="display:none;">
                <span class="audio-label">ä¸å¸¶æ°£ï¼š</span>
                <button class="icon-btn" style="background:var(--play-color)" onclick="playAudio(2)">â–¶</button>
                <button class="icon-btn" style="background:var(--stop-color)" onclick="stopAudio()">â– </button>
            </div>
        </div>

        <h3 class="section-title">å¿ƒç†åŠŸèª²</h3>
        <textarea id="edit-mental" oninput="autoResize(this)"></textarea>

        <h3 class="section-title">ç”Ÿç†åŠŸèª²</h3>
        <textarea id="edit-physical" oninput="autoResize(this)"></textarea>

        <h3 class="section-title">æ³¨æ„äº‹é …</h3>
        <textarea id="edit-note" class="note-area" oninput="autoResize(this)" placeholder="è«‹è¼¸å…¥æ³¨æ„äº‹é …..."></textarea>

        <h3 class="section-title" id="title-qi">å‹•ä½œå£è¨£</h3>
        <textarea id="edit-steps" class="qi-area" oninput="autoResize(this)" placeholder="è«‹è¼¸å…¥è©³ç´°å£è¨£..."></textarea>

        <div id="no-qi-block" style="display:none;">
            <h3 class="section-title">å‹•ä½œå£è¨£ (ä¸å¸¶æ°£ç‰ˆ)</h3>
            <textarea id="edit-no-qi" class="no-qi-area" oninput="autoResize(this)" placeholder="è«‹è¼¸å…¥ä¸å¸¶æ°£å£è¨£..."></textarea>
        </div>

        <button class="save-btn" onclick="saveData()">ğŸ’¾ å„²å­˜æ­¤å¼ä¿®æ”¹ä¸¦ä¿ç•™</button>
    </div>
</div>

<script>
    // é è¨­è³‡æ–™ (è‹¥ç„¡èˆŠè³‡æ–™æ™‚ä½¿ç”¨)
    const defaultData = {
        1: { name: "ç¦®ä½›æ‹œå¸«", mental: "ä»¥äº”å¯¶ä¹‹ç†å¾·ç‚ºå¸«...", physical: "æ´»å‹•è„Šæ¤ç­‰é—œç¯€..." },
        2: { name: "æ³•è¼ªå¸¸è½‰", mental: "ä¸–å‡ºä¸–æ³•ï¼Œåœ“é€šè‡ªåœ¨...", physical: "é€šå’Œå…¨èº«æ°£è„ˆ..." },
        3: { 
            name: "èº«å¿ƒä¸€å¦‚", 
            mental: "çœŸç©ºå³æ˜¯å¦™æœ‰ï¼Œèº«å¿ƒä¸€å¦‚...",
            physical: "(1)ä»¥è…¹å‘¼å¸ç‚ºä¸»...(2)æœ‰ç›Šæ²»ç™‚è…è™›...",
            stepsText: "åšå‹•ç¦ªå‰å…ˆç¥ˆæ±‚ï¼šé›™æ‰‹å„çµä¸€æ³•å°...",
            stepsTextNoQi: "é›™è…³æ‰“é–‹èˆ‡è‚©åŒå¯¬ï¼Œè…³æŒå¹³è¡Œï¼Œå¾®å¾®å…§æ‰£..."
        },
        // ... (å…¶é¤˜ 4-24 å¼ä¿ç•™é è¨­æ¨™é¡Œ)
        4:{name:"æ…§çœ¼è§€ç©º"}, 5:{name:"ç©ºå³æ˜¯è‰²"}, 6:{name:"å¤©è€³åœ“é€š"}, 7:{name:"æ’é™¤å››å¤§"}, 8:{name:"é¼»èæ³•é¦™"},
        9:{name:"é ‚å¤©ç«‹åœ°"}, 10:{name:"ç¬‘å£å¸¸é–‹"}, 11:{name:"èˆŒåè“®è¯"}, 12:{name:"æ©«å‡ºä¸‰ç•Œ"}, 13:{name:"é™é¾ä¼è™"},
        14:{name:"å“ç«‹ç‰¹è¡Œ"}, 15:{name:"å…­åº¦åœ“ä¿®"}, 16:{name:"æŠ–è½æ ¹å¡µ"}, 17:{name:"åˆæ®µç¸½çµå¼"}, 18:{name:"è¡Œè…³å››æ–¹"},
        19:{name:"ç™¾æ­¥è¡ŒåŠŸ"}, 20:{name:"ååº¦åœ“ä¿®"}, 21:{name:"å¤©åœ°éœ‡å‹•"}, 22:{name:"å¤§å¦‚æ„æŒå‰è¡Œ"}, 23:{name:"åŠ›åŒ–å…­é“"}, 24:{name:"è‹¦è¡Œç²¾é€²"}
    };

    // è³‡æ–™é·ç§»é‚è¼¯ï¼šå˜—è©¦å¾èˆŠç‰ˆæœ¬ Key è®€å–
    let savedData = localStorage.getItem('zenDataV1_2') || 
                    localStorage.getItem('zenDataV1_1') || 
                    localStorage.getItem('zenDataV1');
    
    let zenData = savedData ? JSON.parse(savedData) : defaultData;
    let activeId = null;
    let currentAudio = new Audio();

    // æ¸²æŸ“åˆ—è¡¨
    const listContainer = document.getElementById('main-list');
    Object.keys(defaultData).forEach(id => {
        const div = document.createElement('div');
        div.className = 'zen-item';
        div.innerText = `${id}. ${defaultData[id].name}`;
        div.onclick = () => showDetail(id);
        listContainer.appendChild(div);
    });

    // è‡ªå‹•èª¿æ•´ Textarea é«˜åº¦
    function autoResize(el) {
        el.style.height = 'auto';
        el.style.height = el.scrollHeight + 'px';
    }

    function showDetail(id) {
        activeId = parseInt(id);
        const item = zenData[id] || { name: defaultData[id].name };
        document.getElementById('main-list').style.display = 'none';
        document.getElementById('detail-view').style.display = 'block';
        document.getElementById('detail-title').innerText = `${id}. ${item.name}`;
        
        const isSpecial = [3, 7, 9].includes(activeId);
        document.getElementById('label-qi').innerText = isSpecial ? "ç…‰æ°£ç‰ˆï¼š" : "å£è¨£ï¼š";
        document.getElementById('audio-row-2').style.display = isSpecial ? "flex" : "none";
        document.getElementById('title-qi').innerText = isSpecial ? "å‹•ä½œå£è¨£ (å¸¶æ°£ç‰ˆ)" : "å‹•ä½œå£è¨£";
        document.getElementById('no-qi-block').style.display = isSpecial ? "block" : "none";

        // å¡«å…¥è³‡æ–™ä¸¦è§¸ç™¼è‡ªå‹•èª¿æ•´é«˜åº¦
        const fields = {
            'edit-mental': item.mental || defaultData[id]?.mental || "",
            'edit-physical': item.physical || defaultData[id]?.physical || "",
            'edit-note': item.note || "",
            'edit-steps': item.stepsText || defaultData[id]?.stepsText || "",
            'edit-no-qi': item.stepsTextNoQi || defaultData[id]?.stepsTextNoQi || ""
        };

        for (let key in fields) {
            const el = document.getElementById(key);
            el.value = fields[key];
            autoResize(el);
        }
        
        window.scrollTo(0,0);
    }

    function saveData() {
        if(!zenData[activeId]) zenData[activeId] = { name: defaultData[activeId].name };
        
        zenData[activeId].mental = document.getElementById('edit-mental').value;
        zenData[activeId].physical = document.getElementById('edit-physical').value;
        zenData[activeId].note = document.getElementById('edit-note').value;
        zenData[activeId].stepsText = document.getElementById('edit-steps').value;
        if ([3, 7, 9].includes(activeId)) {
            zenData[activeId].stepsTextNoQi = document.getElementById('edit-no-qi').value;
        }

        localStorage.setItem('zenDataV1_2', JSON.stringify(zenData));
        alert("ç¬¬ " + activeId + " å¼å„²å­˜æˆåŠŸï¼è³‡æ–™å·²é·ç§»è‡³ V1.2ã€‚");
    }

    function showList() {
        stopAudio();
        document.getElementById('main-list').style.display = 'grid';
        document.getElementById('detail-view').style.display = 'none';
    }

    function playAudio(v) {
        const name = zenData[activeId]?.name || defaultData[activeId].name;
        const suffix = (v === 2) ? "2" : "";
        currentAudio.src = `${name}${suffix}.mp3`;
        currentAudio.play().catch(() => alert("æœªæ‰¾åˆ°éŸ³æª”"));
    }

    function stopAudio() { currentAudio.pause(); currentAudio.currentTime = 0; }
</script>

</body>
</html>
