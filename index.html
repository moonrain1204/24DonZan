<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ä½›ä¹˜ç¦ªåŠŸ 24 å¼é›²ç«¯ç‰ˆ (V2.1)</title>
    <style>
        :root {
            --primary-color: #8e44ad;
            --bg-color: #f4f7f6;
            --card-bg: #ffffff;
            --text-color: #333;
            --play-color: #27ae60;
            --stop-color: #e74c3c;
            --save-btn: #2ecc71;
            --table-border: #dcdde1;
            --sheet-color: #1d8548;
        }

        body { font-family: "Microsoft JhengHei", sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 15px; }
        .container { max-width: 1100px; margin: 0 auto; }
        .version-tag { text-align: right; font-size: 0.8rem; color: #888; }

        header { text-align: center; padding: 20px 0; border-bottom: 2px solid var(--primary-color); margin-bottom: 20px; }
        header h1 { margin-bottom: 5px; font-size: 1.8rem; }
        
        .master-player {
            background: #fff; border: 2px solid var(--primary-color); border-radius: 15px;
            padding: 15px; margin-bottom: 30px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.1);
        }

        .btn-group { display: flex; gap: 10px; justify-content: center; margin-top: 10px; }
        .btn-sheet { background: var(--sheet-color); color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-size: 0.9rem; text-decoration: none; display: inline-flex; align-items: center; }

        .zen-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(130px, 1fr)); gap: 10px; margin-bottom: 40px; }
        .zen-item { background: var(--card-bg); padding: 12px; text-align: center; border-radius: 8px; cursor: pointer; font-weight: bold; border: 1px solid #ddd; transition: 0.2s; }
        .zen-item:hover { background: #f0e6ff; border-color: var(--primary-color); transform: translateY(-2px); }

        #detail-view { display: none; background: var(--card-bg); padding: 20px; border-radius: 12px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); margin-bottom: 40px; }
        .back-btn { background: #95a5a6; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-bottom: 20px; }
        .save-btn { background: var(--save-btn); color: white; border: none; padding: 15px 25px; border-radius: 5px; cursor: pointer; font-size: 1.1rem; width: 100%; margin-top: 30px; font-weight: bold; box-shadow: 0 4px 0 #27ae60; }

        .audio-row { display: flex; align-items: center; gap: 15px; margin-bottom: 10px; background: #f9f9f9; padding: 10px; border-radius: 8px; border: 1px solid #eee; justify-content: center; }
        .icon-btn { border: none; width: 45px; height: 45px; border-radius: 50%; cursor: pointer; color: white; font-size: 1.2rem; display: flex; align-items: center; justify-content: center; }

        table { width: 100%; border-collapse: collapse; background: white; font-size: 0.9rem; table-layout: fixed; }
        th, td { border: 1px solid var(--table-border); padding: 10px 5px; vertical-align: top; }
        th { background-color: var(--primary-color); color: white; }
        .col-header { width: 75px; font-size: 0.8rem; background-color: #f1f2f6; text-align: center; font-weight: bold; }
        .pre-wrap { white-space: pre-wrap; word-break: break-all; }
        .section-title { color: var(--primary-color); border-left: 5px solid var(--primary-color); padding-left: 10px; margin: 25px 0 10px; }
        textarea { width: 100%; min-height: 80px; padding: 12px; border: 1px solid #ccc; border-radius: 8px; font-family: inherit; font-size: 1.1rem; line-height: 1.6; resize: none; overflow: hidden; }
    </style>
</head>
<body>

<div class="container">
    <div class="version-tag">Version 2.1 (Cloud Sync)</div>
    <header>
        <h1>ä½›ä¹˜ç¦ªåŠŸ 24 å¼</h1>
        <p>å¿ƒç†èˆ‡ç”Ÿç†åŠŸèª²åŒæ­¥ç³»çµ±</p>
    </header>

    <div id="main-list-container">
        <div class="master-player">
            <span style="font-weight:bold; color:var(--primary-color)">ğŸ§˜ å‹•ç¦ªå¿ƒæ³•æ’­æ”¾èˆ‡é›²ç«¯åŒæ­¥</span>
            <div class="audio-row">
                <button class="icon-btn" style="background:var(--play-color)" onclick="playMaster()">â–¶</button>
                <button class="icon-btn" style="background:var(--stop-color)" onclick="stopAudio()">â– </button>
            </div>
            <div id="master-time-info" style="font-size:0.9rem; color:#666;">
                æ‰€éœ€æ™‚é–“ï¼š<span id="duration-text">--åˆ†--ç§’</span> | é è¨ˆçµæŸï¼š<span id="range-text">--:--</span>
            </div>
            <div class="btn-group">
                <a href="https://docs.google.com/spreadsheets/d/1sRdGK99bjGdPZTxf9oxvHg7JbIR635CEzTq5IrFCn_A/edit" target="_blank" class="btn-sheet">ğŸ“Š æ‰“é–‹æˆ‘çš„é›²ç«¯è©¦ç®—è¡¨</a>
            </div>
        </div>

        <div id="main-list" class="zen-list"></div>
        
        <div id="summary-section">
            <h3 class="section-title">å…¨ 24 å¼åŠŸèª²å…§å®¹ç¸½è¦½</h3>
            <table id="summary-table">
                <thead><tr><th style="width:75px;">å¼åˆ¥</th><th>å¿ƒç†åŠŸèª²</th><th>ç”Ÿç†åŠŸèª²</th></tr></thead>
                <tbody id="summary-body"></tbody>
            </table>
        </div>
    </div>

    <div id="detail-view">
        <button class="back-btn" onclick="showList()">â† è¿”å›åˆ—è¡¨</button>
        <h2 id="detail-title"></h2>
        <h3 class="section-title">å¿ƒç†åŠŸèª²</h3>
        <textarea id="edit-mental" oninput="autoResize(this)"></textarea>
        <h3 class="section-title">ç”Ÿç†åŠŸèª²</h3>
        <textarea id="edit-physical" oninput="autoResize(this)"></textarea>
        <button class="save-btn" onclick="saveData()">ğŸ’¾ å„²å­˜ä¸¦åŒæ­¥è‡³é›²ç«¯</button>
    </div>
</div>

<script>
    // æ ¹æ“šæ‚¨çš„é€£çµæå–çš„é›²ç«¯è¨­å®š
    const CONFIG = {
        formID: "1FAIpQLSc-AdHXVh3Bx4Z4uJ0koDLgTnlj0hVQ2nwaMKd-4GW9dlysGQ",
        entryID: "entry.654147474",
        entryMental: "entry.427101914",
        entryPhysical: "entry.1368767787"
    };

    // å…§å»º 24 å¼åŸå§‹è³‡æ–™ (æ ¹æ“šç…§ç‰‡å»ºæª”)
    const baseData = {
        1: { name: "ç¦®ä½›æ‹œå¸«", m: "ä»¥äº”å¯¶ä¹‹ç†å¾·ç‚ºå¸«ï¼Œç™¼å¤§å®é¡˜è¡Œï¼Œå°Šå¸«é‡é“ï¼Œå­æ•¬è¦ªé•·ï¼Œå»ºç«‹ä»¥é–€è¦ç‚ºä¾æ­¢çš„å€«ç†ç§©åºã€‚", p: "(1)å°Šå¸«é‡é“ï¼Œå€«ç†ç§©åºç¦®ç¯€ä¹‹éµå®ˆã€‚(2)æ´»å‹•è„Šæ¤ç­‰é—œéµï¼Œå°è„Šæ¤ã€é—œç¯€ã€è…¸èƒƒæœ‰åŠ©ç›Šä¹‹æ•ˆã€‚ä¸¦å¯å°æ²»æˆ‘æ…¢ï¼ŒåŸ¹é¤Šæ­æ•¬å¿ƒèˆ‡è¬™è®“å¿ƒã€‚" },
        2: { name: "æ³•è¼ªå¸¸è½‰", m: "ä¸–å‡ºä¸–æ³•ï¼Œåœ“é€šè‡ªåœ¨ï¼Œä»¥å››æ”æ³•æ™®åº¦çœ¾ç”Ÿã€‚", p: "é€šå’Œå…¨èº«æ°£è„ˆï¼Œå°é—œç¯€ã€é¢¨æ¿•åŠå…§è‡Ÿç­‰æ…¢æ€§ç—…æœ‰åŠ©ç™‚ä¹‹ç›Šã€‚" },
        3: { name: "èº«å¿ƒä¸€å¦‚", m: "çœŸç©ºå³æ˜¯å¦™æœ‰ï¼Œèº«å¿ƒä¸€å¦‚ï¼Œç†äº‹ä¸äºŒï¼Œæ…ˆæ‚²å¹³ç­‰ï¼Œå››ç„¡é‡å¿ƒä¹‹è¡ŒæŒã€‚", p: "(1)ä»¥è…¹å‘¼å¸ç‚ºä¸»ï¼ŒåŠ å¼·è…°è…åŠå…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚(2)æœ‰ç›Šæ²»ç™‚è…è™›ã€è…¸èƒƒç—…åŠèº«å¼±å¼•èµ·çš„æ…¢æ€§ç—…ã€‚" },
        4: { name: "æ…§çœ¼è§€ç©º", m: "ä¼æ–·ä¸‰æƒ‘ï¼ŒçœŸç©ºå¦™æœ‰çš„ä¸€å¦‚ã€‚", p: "å¢å¼·è¦–åŠ›åŠè…¦åŠ›åŠŸèƒ½ä¹‹è¡ŒåŠŸã€‚" },
        5: { name: "ç©ºå³æ˜¯è‰²", m: "åœ“è­‰æ³•èº«ï¼Œåæ–¹ä¸‰ä¸–ä¸€å¿ƒå¦‚å¦‚ï¼Œæ•…çœŸç©ºä»æ˜¯å¦™æœ‰ã€‚", p: "(1)ç‚ºåŠ å¼·å’Œå”å…¨èº«å„éƒ¨æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚(2)å°é¢¨æ¿•ã€ç¥ç¶“ç—›ã€è…¸èƒƒç—…ã€è‚ºã€è‚ç­‰æ…¢æ€§ç—…æœ‰åŠ©ç™‚ä¹‹æ•ˆã€‚" },
        6: { name: "å¤©è€³åœ“é€š", m: "æ˜è¾¨æ˜¯éã€å–„æƒ¡ã€å…¬ç§ä¹‹ç•Œï¼Œè«¸æƒ¡è«ä½œï¼Œçœ¾å–„å¥‰è¡Œï¼Œåèèè‡ªæ€§ï¼Œæ–¹ä¾¿å³æ˜¯ç©¶ç«Ÿã€‚", p: "å¢å¼·è½åŠ›ã€è…¦åŠ›åŠŸèƒ½ä¹‹è¡ŒåŠŸã€‚" },
        7: { name: "æ’é™¤å››å¤§", m: "åœ°æ°´ç«é¢¨ï¼Œå››å¤§èª¿å’Œï¼Œèº«å¼·æ°£å’Œï¼Œå¿ƒæ·¨æ–¹æ˜“ä¿®è¡Œã€‚", p: "ä»¥è‚ºéƒ¨ã€å…§è‡Ÿç‚ºä¸»ï¼ŒåŠ å¼·å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸï¼Œå°ä¸€åˆ‡å…§ç§‘æ…¢æ€§ç—…æœ‰æ‰€åŠ©ç›Šã€‚" },
        8: { name: "é¼»èæ³•é¦™", m: "æ‚Ÿå‰ä¾æ³•ä¿®ï¼Œæ‚Ÿå¾Œæ³•æ˜¯å¡µï¼Œå±±çª®æ°´ç›¡è™•ï¼ŒæŸ³æš—èŠ±æ˜åˆä¸€æ˜ã€‚", p: "å¢å¼·é¼»éƒ¨ã€å‘¼å¸å™¨å®˜åŠè…¦éƒ¨åŠŸèƒ½ä¹‹è¡ŒåŠŸã€‚" },
        9: { name: "é ‚å¤©ç«‹åœ°", m: "é“å¾·äº‹åŠŸï¼Œå¿—èˆ‡ä½›é½Šï¼Œæ‚²æ™ºé¡˜è¡Œï¼Œä¸€è¡Œåœ“ä¿®ï¼Œèƒ½å¦‚æ˜¯ï¼Œæ¸´æœ›ä½œå¤©äººå¸«ã€‚", p: "ä»¥é ­ç‚ºä¸»ï¼Œè²«å’Œå…¨èº«æ°£è„ˆä¹‹è¡ŒåŠŸã€‚" },
        10: { name: "ç¬‘å£å¸¸é–‹", m: "ä¸€éŸ³èªªæ³•ï¼Œåæ–¹æ™®èï¼Œå¸ƒæ–½ã€æ„›èªã€åˆ©è¡Œã€åŒäº‹ç‚ºè©è–©åº¦çœ¾ä¹‹å››æ”æ³•ã€‚", p: "ä»¥å‘¼å¸ç³»çµ±ã€é£Ÿé“ç‚ºä¸»ï¼ŒåŠ å¼·å…§è‡ŸåŠŸèƒ½ç™¼è²ç…‰æ°£å°è‚ºã€å¿ƒã€è‚ã€è…¸èƒƒã€è…¦éƒ¨ç­‰æ…¢æ€§ç—…æœ‰åŠ©ç™‚ä¹‹ç›Šè™•ã€‚" },
        11: { name: "èˆŒåè“®è¯", m: "å…©èˆŒã€æƒ¡å£ã€å¦„è¨€ã€ç¶ºèªç‚ºæ•—å¾·ä¹‹è¡Œï¼Œæ•…è¨€å¿…æ­£ã€‚", p: "ä»¥ç¥ç¶“ç³»çµ±ç‚ºä¸»ï¼ŒåŠ å¼·å’Œå”å‘¼å¸ç³»çµ±ã€è…¦éƒ¨åŠå…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚" },
        12: { name: "æ©«å‡ºä¸‰ç•Œ", m: "å¿µä½›ç‚ºå¾€ç”Ÿæ·¨åœŸä¹‹å¤§æ³•ï¼Œä¸€è²ä½›è™Ÿï¼Œæˆ’ã€å®šã€æ…§å…·è¶³ï¼Œç•¶ä¸‹è¥¿æ–¹æ·¨åœŸåœ¨è‡ªæ€§ä¸­ã€‚", p: "ä»¥è¶³ç‚ºä¸»ï¼ŒåŠ å¼·å’Œå”å…¨æ°£èƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸï¼Œä¸¦æœ‰ç›Šæ‰“é€šå…©è…¿æ°£è„ˆã€‚" },
        13: { name: "é™é¾ä¼è™", m: "è²ªã€å—”ã€ç™¡ä¸‰æ¯’ï¼Œç‚ºç”Ÿæ­»è¼ªè¿´ä¹‹å› ï¼Œå®šæ…§ç­‰æŒï¼Œç•¶ä¸‹ç…©æƒ±å³æ˜¯è©æã€‚", p: "èº«ã€å¿ƒã€æ°£ã€åŠ›åˆç”¨ï¼ŒåŠ å¼·å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚å°è„Šæ¤ã€é—œç¯€å…·å¼·åŒ–åŠŸç”¨ï¼Œä¸¦æ˜“æ–¼æ‰“é€šå‰å¾ŒäºŒè„ˆã€‚" },
        14: { name: "å“ç«‹ç‰¹è¡Œ", m: "å¿—é¡˜ä½œä½›ï¼Œä¾æ³•ä¿®è¡Œï¼Œä¸ç‚ºä¸–é–“åèåˆ©é¤Šï¼Œä»¥è‡³ç”Ÿæ­»è€Œç§»å…¶å¿ƒå¿—ã€‚", p: "ä»¥è¶³ç‚ºä¸»ï¼ŒåŠ å¼·å’Œå”å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚" },
        15: { name: "å…­åº¦åœ“ä¿®", m: "å…­åº¦ä¸€è¡Œä¿®ï¼Œè¬å¾·ç”±å¿ƒåœ“ï¼Œäº‹ç†ä¸äºŒï¼Œè­‰é“ä¹‹é–€ã€‚", p: "(1)èº«ã€å¿ƒã€æ°£ã€åŠ›åˆä¸€ï¼ŒåŠ å¼·å’Œå”å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚(2)å°è‚ã€è…ã€è…¸ã€èƒƒã€è‚©è†€èˆ‡èƒ¯éƒ¨é—œç¯€ç­‰æœ‰ç›Šä¹‹è¡ŒåŠŸã€‚" },
        16: { name: "æŠ–è½æ ¹å¡µ", m: "è¿´è„«æ ¹å¡µï¼Œè½‰è­˜æˆæ™ºï¼Œä»¥å…¥ä½›ä¹‹ç†å¢ƒã€‚", p: "ä»¥ç¥ç¶“ç³»çµ±ç‚ºä¸»ï¼ŒåŠ å¼·å’Œå”å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚" },
        17: { name: "åˆæ®µç¸½çµå¼", m: "é¬†ã€æ…¢ã€æŸ”ã€ç©ºï¼Œæœ‰å¿µé€²å…¥ç„¡å¿µï¼Œå…ˆç ´ç”Ÿç†åŸ·è‘—ï¼Œé€²è€Œç ´å¿ƒç†åŸ·è‘—ã€‚", p: "èº«ã€å¿ƒã€æ°£ä½œæœ€åœ“æ»¿çš„å’Œå”ï¼Œä»¥åˆ©æ‰“é€šå‰å¾Œè„ˆã€ç™¾è„ˆã€ç™¾ç«…ã€‚" },
        18: { name: "è¡Œè…³å››æ–¹", m: "åˆç™¼å¿ƒè©è–©ï¼Œå»£åƒè‰¯å¸«ç›Šå‹ï¼Œä»¥å»£é€²å¾·ä¿®æ¥­ä¹‹åŠŸã€‚", p: "ä»¥è¶³ç‚ºä¸»ï¼Œèº«ã€å¿ƒã€æ°£ã€åŠ›åˆä¸€ã€å‹•éœã€æ—‹è½‰ã€æ˜“ä½ã€é€Ÿåº¦ã€é‡å¿ƒå¹³è¡¡ã€è®Šæ˜“ä¹‹è¡ŒåŠŸã€‚" },
        19: { name: "ç™¾æ­¥è¡ŒåŠŸ", m: "ç²¾é€²æ­¡å–œï¼Œç¯¤è¡Œé–€è¦ï¼Œä¹ƒå¯æˆå°±ä½›é“ã€‚", p: "(1)å°è„Šæ¤ã€è…¦éƒ¨åŠé€šä¸‹è¡Œæ°£æœ‰æ‰€åŠ©ç›Šä¹‹è¡ŒåŠŸã€‚(2)æ¸›è‚¥ã€‚" },
        20: { name: "ååº¦åœ“ä¿®", m: "å…­åº¦ã€æ–¹ä¾¿åº¦ã€é¡˜åº¦ã€åŠ›åº¦ã€æ™ºåº¦ç­‰ååº¦åœ“æ»¿ã€‚", p: "(1)åŠ å¼·è„Šæ¤ã€èƒ¯éª¨ã€æ‰‹è…³é—œéµã€è…¦éƒ¨åŠŸèƒ½ä¹‹è¡ŒåŠŸã€‚(2)æ¸›è‚¥ã€‚" },
        21: { name: "å¤©åœ°éœ‡å‹•", m: "ä¸€å¤šåœ“èï¼Œåæ–¹ä¸‰ä¸–è¬æ³•çµ±ä¸€æ–¼ä¸€å·±ä¹‹æ³•èº«ä¸­ï¼Œæ•…å¯¦è­‰æ³•èº«ï¼Œåæ–¹éœ‡å‹•ã€‚", p: "ä»¥è…¦ç¥ç¶“ç‚ºä¸»ï¼ŒåŠ å¼·å’Œå”å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚" },
        22: { name: "å¤§å¦‚æ„æŒå‰è¡Œ", m: "è³‡æ–™æ•´ç†ä¸­", p: "è³‡æ–™æ•´ç†ä¸­" },
        23: { name: "åŠ›åŒ–å…­é“", m: "è©è–©ä»¥äººå¤©å¸«è¤“è‡ªä»»ï¼Œé«”ã€ç›¸ã€æ™ºã€å¾·ã€ç†ã€äº‹ã€èƒ½ã€ç”¨ã€æ™‚ã€ç©ºåå¤§ä¸€å¦‚ï¼Œå¹³ç­‰æ¿Ÿåº¦çœ¾ç”Ÿã€‚", p: "èº«ã€å¿ƒã€æ°£ã€åŠ›ä¸€å¦‚ï¼Œèƒ½ç”¨åˆä¸€ã€è®Šç”¨ä¹‹è¡ŒåŠŸã€‚" },
        24: { name: "è‹¦è¡Œç²¾é€²", m: "è©è–©è¡Œè€…ï¼Œè‹¦æ¨‚ä¸è‘—ï¼Œè‡ªè¦ºè¦ºä»–ï¼Œå¼˜æ³•åˆ©ç”Ÿï¼Œæ°¸ä¸æ‡ˆæ€ ã€‚", p: "ä»¥è…°è…¿ç‚ºä¸»ï¼ŒåŠ å¼·å’Œå”å…¨èº«æ©Ÿèƒ½åŠŸç”¨ä¹‹è¡ŒåŠŸã€‚" }
    };

    let zenData = JSON.parse(localStorage.getItem('zenSyncV2.1')) || {};
    let activeId = null;
    let masterAudio = new Audio('å‹•ç¦ªå¿ƒæ³•.mp3');

    function init() {
        // åˆä½µåŸå§‹è³‡æ–™èˆ‡ä½¿ç”¨è€…ä¿®æ”¹éçš„è³‡æ–™
        for(let i=1; i<=24; i++) {
            if(!zenData[i]) {
                zenData[i] = { 
                    name: baseData[i].name, 
                    mental: baseData[i].m, 
                    physical: baseData[i].p 
                };
            }
        }
        renderList();
        renderSummaryTable();
        masterAudio.addEventListener('loadedmetadata', () => {
            const min = Math.floor(masterAudio.duration/60);
            const sec = Math.floor(masterAudio.duration%60);
            document.getElementById('duration-text').innerText = `${min}åˆ†${sec}ç§’`;
        });
    }

    function renderList() {
        const list = document.getElementById('main-list');
        list.innerHTML = '';
        for(let i=1; i<=24; i++) {
            const div = document.createElement('div');
            div.className = 'zen-item';
            div.innerText = `${i}. ${baseData[i].name}`;
            div.onclick = () => showDetail(i);
            list.appendChild(div);
        }
    }

    function renderSummaryTable() {
        const tbody = document.getElementById('summary-body');
        tbody.innerHTML = '';
        for(let i=1; i<=24; i++) {
            const item = zenData[i];
            const tr = document.createElement('tr');
            tr.innerHTML = `<td class="col-header">${i}.<br>${item.name}</td><td class="pre-wrap">${item.mental||""}</td><td class="pre-wrap">${item.physical||""}</td>`;
            tbody.appendChild(tr);
        }
    }

    function showDetail(id) {
        activeId = id;
        document.getElementById('main-list-container').style.display='none';
        document.getElementById('detail-view').style.display='block';
        document.getElementById('detail-title').innerText = `${id}. ${zenData[id].name}`;
        document.getElementById('edit-mental').value = zenData[id].mental;
        document.getElementById('edit-physical').value = zenData[id].physical;
        setTimeout(() => document.querySelectorAll('textarea').forEach(autoResize), 50);
        window.scrollTo(0,0);
    }

    function showList() {
        document.getElementById('main-list-container').style.display='block';
        document.getElementById('detail-view').style.display='none';
        window.scrollTo(0,0);
    }

    async function saveData() {
        const mental = document.getElementById('edit-mental').value;
        const physical = document.getElementById('edit-physical').value;
        
        zenData[activeId].mental = mental;
        zenData[activeId].physical = physical;
        localStorage.setItem('zenSyncV2.1', JSON.stringify(zenData));

        // åŒæ­¥è‡³ Google Sheets
        const url = `https://docs.google.com/forms/d/e/${CONFIG.formID}/formResponse`;
        const params = new URLSearchParams();
        params.append(CONFIG.entryID, activeId + ". " + zenData[activeId].name);
        params.append(CONFIG.entryMental, mental);
        params.append(CONFIG.entryPhysical, physical);

        try {
            fetch(url, { method: 'POST', mode: 'no-cors', body: params });
        } catch (e) { console.error("åŒæ­¥å¤±æ•—", e); }

        renderSummaryTable();
        alert("å„²å­˜æˆåŠŸï¼è³‡æ–™å·²åŒæ­¥è‡³é›²ç«¯è©¦ç®—è¡¨ã€‚");
    }

    function playMaster() {
        masterAudio.play();
        const end = new Date(Date.now() + (masterAudio.duration || 0) * 1000);
        document.getElementById('range-text').innerText = `${end.getHours()}:${String(end.getMinutes()).padStart(2,'0')}`;
    }

    function stopAudio() { masterAudio.pause(); masterAudio.currentTime = 0; }
    function autoResize(el) { el.style.height = 'auto'; el.style.height = (el.scrollHeight) + 'px'; }

    init();
</script>
</body>
</html>
